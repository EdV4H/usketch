# Lefthook configuration
# https://github.com/evilmartians/lefthook

pre-commit:
  parallel: true
  commands:
    biome-check:
      glob: "*.{js,jsx,ts,tsx,css,json}"
      run: pnpm biome check --write --no-errors-on-unmatched {staged_files}
      stage_fixed: true

commit-msg:
  commands:
    commitlint:
      run: |
        # Validate commit message format
        commit_regex='^(âœ¨|ğŸ›|â™»ï¸|ğŸ¨|âš¡ï¸|ğŸ”¥|ğŸ’„|âœ…|ğŸ”§|ğŸ“|ğŸš€|ğŸ”’|ğŸ©¹|ğŸŒ|âœï¸|â¬†ï¸|â¬‡ï¸|ğŸ“Œ|ğŸ‘·|ğŸ“ˆ|â™¿ï¸|ğŸ—ï¸|ğŸ”Š|ğŸ”‡|ğŸš¨|ğŸš§|ğŸ’š|âª|ğŸ”€|ğŸ“¦|ğŸ‘½ï¸|ğŸšš|ğŸ“„|ğŸ’¥|ğŸ±|â™¿ï¸|ğŸ’¬|ğŸ—ƒï¸|ğŸ”Š|ğŸ”‡|ğŸ”§) (feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\(.+\))?: .{1,50}'
        
        if ! grep -qE "$commit_regex" "$1"; then
          echo "âŒ Invalid commit message format!"
          echo ""
          echo "ğŸ“ Commit message must follow the format:"
          echo "   <gitmoji> <type>(<scope>): <subject>"
          echo ""
          echo "ğŸ“‹ Examples:"
          echo "   âœ¨ feat: add new feature"
          echo "   ğŸ› fix(auth): resolve login issue"
          echo "   â™»ï¸ refactor: improve code structure"
          echo "   ğŸ“ docs: update README"
          echo ""
          echo "ğŸ¯ Types: feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert"
          echo ""
          echo "ğŸ¨ Common gitmojis:"
          echo "   âœ¨ feat       - New feature"
          echo "   ğŸ› fix        - Bug fix"
          echo "   â™»ï¸ refactor   - Code refactoring"
          echo "   ğŸ¨ style      - Code formatting"
          echo "   âš¡ï¸ perf       - Performance improvement"
          echo "   ğŸ“ docs       - Documentation"
          echo "   âœ… test       - Tests"
          echo "   ğŸ”§ config     - Configuration"
          exit 1
        fi

# Skip hooks in CI environment
skip_output:
  - meta
  - summary
